{% extends "master.html" %}

{% block title %}
Password Manager Vault
{% endblock %}

{% block content %}
<head>
    <title>Password Manager - Vault</title>
    <script>
        // When the user clicks on <div>, open the popup
        function showPopup() {
            let popup = document.getElementById("item-popup");
            let backdrop = document.getElementById("popup-backdrop");
            popup.classList.add("show");
            backdrop.classList.add("show");
        }

        // Close the popup
        function closePopup() {
            let popup = document.getElementById("item-popup");
            let backdrop = document.getElementById("popup-backdrop");
            popup.classList.remove("show");
            backdrop.classList.remove("show");
        }

        // Close popup when clicking outside of it
        window.onclick = function (event) {
            let popup = document.getElementById("item-popup");
            let backdrop = document.getElementById("popup-backdrop");
            if (event.target === backdrop) {
                popup.classList.remove("show");
                backdrop.classList.remove("show");
            }
        }

        // Toggle password visibility
        function togglePassword(element) {
            element.classList.toggle('hidden');
        }
    </script>
</head>
<div class="hero-section">
    <div class="hero-title">
        <h1>Password Manager Vault</h1>
    </div>

    <h2 class="hero-subtitle">Welcome to Your Vault</h2>
    <p class="hero-subtitle">Here you can see and manage your stored passwords</p>

    <div class="vault-items-container">
        <!-- Display error/success messages -->
        {% if messages %}
        <div class="alert alert-primary" role="alert">
            {% for message in messages %}
            {{ message }}
            {% endfor %}
        </div>
        {% endif %}

        {% for item in items %}
        <div class="vault-item">
            <div class="item-info">
                <div class="item-field">
                    <span class="item-label">Name</span>
                    <span class="item-value item-title">{{ item.name }}</span>
                </div>
                <div class="item-field">
                    <span class="item-label">Username</span>
                    <span class="item-value item-username">{{ item.username }}</span>
                </div>
                <div class="item-field">
                    <span class="item-label">Password</span>
                    <span class="item-value item-password hidden" onclick="togglePassword(this)">
                        <span class="password-text">{{ item.password }}</span>
                    </span>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <button class="btn btn-primary popup" onclick="showPopup()">Add Item</button>

    <!-- Backdrop overlay -->
    <div id="popup-backdrop" class="popup-backdrop"></div>

    <div id="item-popup">
        {% include "item-creation.html" %}
    </div>
</div>
{% endblock %}