{% extends "master.html" %}

{% block title %}Use a recovery code{% endblock %}

{% block content %}
<section class="page-header">
    <div>
        <h1 class="page-title">Enter recovery code</h1>
        <p class="page-description">Provide one of the backup codes you stored when setting up multi-factor authentication.</p>
    </div>
</section>

<section class="card form-card">
    <form method="post" action="{% url 'recovery_code_login' %}" class="form-grid">
        {% csrf_token %}
        {% if user_email %}
            <input type="hidden" name="email" value="{{ user_email }}">
        {% else %}
            <label for="email">
                Email address
                <input type="email" id="email" name="email" placeholder="name@example.com" required autocomplete="email">
            </label>
        {% endif %}
        <label for="recovery_code">
            Recovery code
            <input type="text" id="recovery_code" name="recovery_code" maxlength="9" pattern="[A-Z0-9]{4}-[A-Z0-9]{4}" data-format="recovery" autocomplete="off" placeholder="XXXX-XXXX" required>
            <span class="field-hint">Format: XXXX-XXXX.</span>
        </label>
        <button type="submit" class="btn btn-primary">Verify recovery code</button>
    </form>
    <div class="form-footer">
        <p><a href="{% url 'account_login' %}">Return to login</a></p>
        <p>Need new codes? <a href="{% url 'regenerate_recovery_codes' %}">Generate replacements</a>.</p>
    </div>
</section>
{% endblock %}
